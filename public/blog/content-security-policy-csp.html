<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="L4e6eB4hwkgHXit54PWBHjUV5RtnOmznEPwSDbvWTlM" />
    <title>Introducción</title>
    <meta name="description" content="La Content Security Policy (CSP) es un mecanismo de seguridad HTTP que permite a los desarrolladores web controlar los recursos que el navegador puede cargar pa">
    <meta name="keywords" content="JavaScript, Seguridad, IA">
    <meta name="author" content="hgaruna">
    <meta name="robots" content="index, follow">
    
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://www.hgaruna.org/blog/content-security-policy-csp.html">
    <meta property="og:title" content="Introducción">
    <meta property="og:description" content="La Content Security Policy (CSP) es un mecanismo de seguridad HTTP que permite a los desarrolladores web controlar los recursos que el navegador puede cargar pa">
    <meta property="og:image" content="{{SITE_URL}}/logos-he-imagenes/programacion.jpeg"> <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://www.hgaruna.org/blog/content-security-policy-csp.html">
    <meta property="twitter:title" content="Introducción">
    <meta property="twitter:description" content="La Content Security Policy (CSP) es un mecanismo de seguridad HTTP que permite a los desarrolladores web controlar los recursos que el navegador puede cargar pa">
    <meta property="twitter:image" content="{{SITE_URL}}/logos-he-imagenes/programacion.jpeg"> <link rel="canonical" href="https://www.hgaruna.org/blog/content-security-policy-csp.html">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7772175009790237" crossorigin="anonymous"></script>

    <style>
        :root {
            --primary: #10b981;
            --primary-dark: #059669;
            --dark-bg: #0f172a;
            --darker-bg: #0a1122;
            --card-bg: #1e293b;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --border-color: #334155;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.7;
            color: var(--text-primary);
            background-color: var(--dark-bg);
            margin: 0;
            padding: 0;
            display: flex; /* For sticky footer or overall layout if needed */
            flex-direction: column;
            min-height: 100vh;
        }

        /* Ensure main content pushes footer down */
        main {
            flex: 1; /* Allow main content to grow */
        }
        
        .container {
            max-width: 1140px;
        }
        
        /* Header */
        .article-header {
            background: linear-gradient(135deg, var(--darker-bg) 0%, var(--dark-bg) 100%);
            color: white;
            padding: 6rem 0 4rem;
            margin-bottom: 3rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .article-title {
            font-size: 2.75rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            line-height: 1.2;
            background: linear-gradient(90deg, #ffffff, #a7f3d0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .article-meta {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin: 2rem 0;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }
        
        .article-meta span {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .article-meta i {
            color: var(--primary);
        }
        
        /* Content */
        .article-content {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-secondary);
            max-width: 800px; /* Constrain width for readability */
            margin: 0 auto; /* Center content */
            padding: 0 15px; /* Add some horizontal padding for smaller screens */
        }
        
        .article-content h1, 
        .article-content h2, 
        .article-content h3, 
        .article-content h4 {
            color: var(--text-primary);
            margin-top: 2.5rem;
            margin-bottom: 1.5rem;
            font-weight: 700;
        }
        
        /* IMPORTANT: Remove h1 styling from content if you only use h1 in header */
        /* If Gemini generates h1 in content, this might be okay, but typically you have one h1 per page */
        .article-content h1 { /* This styling applies to any h1 generated in <main>
  <h2>Introducción</h2>
  <p>La Content Security Policy (CSP) es un mecanismo de seguridad HTTP que permite a los desarrolladores web controlar los recursos que el navegador puede cargar para una página web dada.  Esto ayuda a mitigar los riesgos de ataques como el Cross-Site Scripting (XSS) y otros tipos de inyección de código malicioso. En esencia, CSP define una política de seguridad que el navegador debe aplicar rigurosamente, bloqueando cualquier recurso que no cumpla con las directivas especificadas.  Implementar una CSP eficaz es una parte crucial de una estrategia de seguridad web robusta.</p>

  <h2>Sección Principal</h2>
  <p>Una CSP se define mediante un encabezado HTTP, <code>Content-Security-Policy</code>, o a través de una etiqueta <code>meta</code>.  Este encabezado o etiqueta contiene una lista de directivas, cada una especificando qué tipos de recursos se permiten cargar y de dónde.  Si un recurso intenta cargarse y no cumple con la política definida, el navegador lo bloqueará, previniendo potenciales ataques.  El uso de CSP es altamente recomendado para cualquier sitio web que maneje datos sensibles o información de usuario.</p>

  <h3>Directivas CSP comunes</h3>
  <p>Existen varias directivas CSP, cada una con su propio propósito. Algunas de las más comunes incluyen:</p>
  <ul>
    <li><code>default-src</code>:  Define una política por defecto para todos los tipos de recursos si no se especifica otra directiva.  Es una buena práctica siempre definir esta directiva.</li>
    <li><code>script-src</code>: Especifica las fuentes permitidas para scripts.  Esto es crucial para prevenir ataques XSS.</li>
    <li><code>style-src</code>: Especifica las fuentes permitidas para hojas de estilo.</li>
    <li><code>img-src</code>: Especifica las fuentes permitidas para imágenes.</li>
    <li><code>font-src</code>: Especifica las fuentes permitidas para fuentes.</li>
    <li><code>object-src</code>: Especifica las fuentes permitidas para objetos como <object>, <embed> y <applet>.</li>
    <li><code>media-src</code>: Especifica las fuentes permitidas para archivos de audio y video.</li>
    <li><code>frame-src</code>: Especifica las fuentes permitidas para iframes.</li>
    <li><code>connect-src</code>: Especifica las fuentes permitidas para conexiones de red, incluyendo solicitudes Fetch y XMLHttpRequest.</li>
    <li><code>base-uri</code>: Especifica las fuentes permitidas para la etiqueta <code><base></code>.</li>
    <li><code>form-action</code>: Especifica las URLs permitidas para las acciones de los formularios.</li>
    <li><code>frame-ancestors</code>: Especifica las fuentes permitidas que pueden incrustar la página actual en un iframe.</li>
    <li><code>child-src</code>: (Obsoleta, reemplazada por <code>frame-src</code> y <code>worker-src</code>) Especifica las fuentes permitidas para frames, workers y otros contextos de navegación de la página.</li>
    <li><code>worker-src</code>: Especifica las fuentes permitidas para los Web Workers.</li>
    <li><code>manifest-src</code>: Especifica las fuentes permitidas para archivos de manifest.</li>
    <li><code>report-uri</code>: Especifica una URL donde se enviarán los informes de violaciones de la CSP.</li>
    <li><code>report-to</code>: Especifica un grupo de reporting para informes de violaciones de la CSP (más avanzado que `report-uri`).</li>
    <li><code>sandbox</code>: Aplica una serie de restricciones de seguridad a la página.</li>
    <li><code>upgrade-insecure-requests</code>: Reemplaza las solicitudes HTTP con HTTPS.</li>
  </ul>


  <h3>Ejemplo de implementación</h3>
  <p>Un ejemplo simple de una CSP que permite scripts solo desde el mismo origen y las imágenes desde un CDN específico:</p>
  <pre><code class="language-javascript">Content-Security-Policy: default-src 'self'; script-src 'self'; img-src 'self' https://cdn.example.com;</code></pre>

  <p>Este ejemplo utiliza la directiva <code>'self'</code>, que se refiere al mismo origen de la página.  Es importante destacar que  <code>'self'</code>  incluye el protocolo, el nombre de dominio y el puerto.  Si la página se carga con HTTPS, solo se permitirán recursos con HTTPS.  Si se carga con HTTP, solo se permitirán recursos con HTTP.</p>

  <h3>Ejemplo con Report-URI</h3>
  <p>Para monitorear las violaciones de la CSP, es útil especificar una <code>report-uri</code>.  Esto enviará informes a la URL especificada cada vez que se produzca una violación.  Esto permite identificar y solucionar posibles problemas de configuración.</p>
  <pre><code class="language-javascript">Content-Security-Policy: default-src 'self'; script-src 'self'; report-uri /csp-reports;</code></pre>
  <p>En este ejemplo, los informes se enviarán a la URL <code>/csp-reports</code> en el mismo servidor.  Recuerda que necesitas implementar un endpoint para manejar estos informes.</p>


  <h3>Consideraciones importantes</h3>
  <ol>
    <li><strong>Comenzar con una política restrictiva y relajarla gradualmente:</strong> Es mejor comenzar con una política muy restrictiva y luego ir relajando las directivas según sea necesario, monitoreando las violaciones a través de la <code>report-uri</code>.</li>
    <li><strong>Pruebas exhaustivas:</strong>  Antes de implementar una CSP en producción, es crucial realizar pruebas exhaustivas para asegurar que todas las funcionalidades del sitio web funcionen correctamente.</li>
    <li><strong>Monitoreo continuo:</strong>  Después de implementar la CSP, es importante monitorear los informes de violaciones para identificar y solucionar cualquier problema.</li>
    <li><strong>Compatibilidad del navegador:</strong> Asegúrate de que tu CSP sea compatible con los navegadores que deseas admitir.  La compatibilidad ha mejorado significativamente, pero siempre es prudente verificar la documentación.</li>
    <li><strong>Nonce y Hash:</strong> Para permitir scripts generados dinámicamente de forma segura, considera el uso de <code>nonce</code> o <code>hash</code> en la directiva <code>script-src</code>.</li>
  </ol>

  <h2>Conclusión</h2>
  <p>Implementar una Content Security Policy es una práctica de seguridad esencial para cualquier sitio web.  Aunque puede requerir un esfuerzo inicial de configuración y pruebas, los beneficios en términos de seguridad superan ampliamente los costos.  Al comprender las directivas CSP y seguir las mejores prácticas, puedes proteger significativamente tu sitio web contra una variedad de ataques comunes, mejorando la seguridad y la confianza de tus usuarios.</p>
  <p>Recuerda que una CSP bien configurada es una capa de defensa crucial, pero no la única.  Es importante combinarla con otras medidas de seguridad, como el uso de HTTPS, la validación de entradas y la gestión segura de contraseñas, para lograr una protección completa.</p>
</main>
 */
            font-size: 2.5rem;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 0.75rem;
            display: inline-block;
            width: 100%; /* Ensure border-bottom spans full width */
        }
        
        .article-content h2 {
            font-size: 2rem;
            position: relative;
            padding-left: 1.5rem;
        }
        
        .article-content h2::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0.5rem;
            height: calc(100% - 1rem);
            width: 4px;
            background: var(--primary);
            border-radius: 2px;
        }
        
        .article-content h3 {
            font-size: 1.5rem;
            color: var(--primary);
        }
        
        .article-content p {
            margin-bottom: 1.75rem;
            font-size: 1.1rem;
            line-height: 1.8;
        }
        
        .article-content a {
            color: var(--primary);
            text-decoration: none;
            transition: all 0.3s ease;
            border-bottom: 1px dotted var(--primary);
        }
        
        .article-content a:hover {
            color: #a7f3d0;
            border-bottom-color: #a7f3d0;
        }
        
        .article-content ul, 
        .article-content ol {
            margin-bottom: 2rem;
            padding-left: 2rem;
        }
        
        .article-content li {
            margin-bottom: 0.75rem;
            position: relative;
        }
        
        .article-content ul li::before {
            content: '•';
            color: var(--primary);
            font-weight: bold;
            display: inline-block;
            width: 1em;
            margin-left: -1em;
        }
        
        .article-content ol {
            counter-reset: item;
        }
        
        .article-content ol li {
            counter-increment: item;
        }
        
        .article-content ol li::before {
            content: counter(item) '.';
            color: var(--primary);
            font-weight: bold;
            margin-right: 0.5rem;
        }
        
        .article-content blockquote {
            border-left: 4px solid var(--primary);
            padding: 1.5rem 2rem;
            margin: 2.5rem 0;
            background: rgba(16, 185, 129, 0.05);
            border-radius: 0 8px 8px 0;
            font-style: italic;
            color: var(--text-primary);
        }
        
        .article-content blockquote p:last-child {
            margin-bottom: 0;
        }
        
        .article-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 2rem 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border-color);
        }
        
        .article-content pre {
            background: var(--darker-bg);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 2rem 0;
            border: 1px solid var(--border-color);
            position: relative; /* For copy button */
        }

        /* Style for code block copy button */
        .copy-code-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background-color: var(--primary-dark);
            color: white;
            border: none;
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: 0.8em;
            cursor: pointer;
            opacity: 0; /* Hidden by default */
            transition: opacity 0.3s ease;
        }
        
        .article-content pre:hover .copy-code-btn {
            opacity: 1; /* Show on hover */
        }
        
        .article-content code {
            font-family: 'Fira Code', 'Courier New', monospace;
            background: rgba(16, 185, 129, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-size: 0.9em;
            color: #a7f3d0;
        }
        
        .article-content pre code {
            background: none;
            padding: 0;
            border-radius: 0;
            white-space: pre-wrap; /* Ensures code wraps within the pre tag */
            word-wrap: break-word; /* For very long lines */
        }
        
        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            cursor: pointer;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
            color: white; /* Ensure text color remains white on hover */
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background: rgba(16, 185, 129, 0.1);
            transform: translateY(-2px);
            color: var(--primary); /* Ensure text color remains primary on hover */
        }
        
        /* Back button */
        .back-button {
            position: fixed;
            top: 2rem;
            left: 2rem;
            z-index: 1000;
        }
        
        .back-button .btn {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }
        
        .back-button .btn:hover {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }
        
        /* Share buttons */
        .share-buttons {
            display: flex;
            gap: 1rem;
            margin: 3rem 0;
            flex-wrap: wrap;
            align-items: center; /* Align items vertically in the row */
        }

        .share-buttons h4 {
            margin-bottom: 0; /* Remove bottom margin from h4 in share buttons */
        }
        
        .share-button { /* These styles are for the old method, replaced by btn-outline-primary */
            /* Removed as they are not used with the Bootstrap button classes */
        }
        
        /* Tags */
        .article-tags {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            margin: 2rem 0 3rem;
            padding: 0 15px; /* Add some horizontal padding for smaller screens */
        }
        
        .tag {
            background: rgba(16, 185, 129, 0.1);
            color: var(--primary);
            padding: 0.35rem 1rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.3s ease;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .tag:hover {
            background: var(--primary);
            color: white;
            text-decoration: none; /* Prevent underline on hover */
        }
        
        /* Author Card */
        .author-card {
            background: var(--card-bg); /* Use a more appropriate background variable */
            color: var(--text-primary);
            padding: 2.5rem; /* Increased padding */
            border-radius: 10px; /* More rounded corners */
            margin-top: 4rem; /* More space above */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3); /* Add some shadow */
            border: 1px solid var(--border-color);
        }

        .author-card img {
            border: 2px solid var(--primary); /* Add border to avatar */
            flex-shrink: 0; /* Prevent image from shrinking */
        }

        .author-card .social-links a {
            color: var(--primary);
            transition: color 0.3s ease;
        }

        .author-card .social-links a:hover {
            color: #a7f3d0;
        }
        
        /* Footer */
        .article-footer {
            margin-top: 4rem;
            padding: 3rem 0;
            border-top: 1px solid var(--border-color);
            background-color: var(--darker-bg); /* Give footer a distinct background */
            text-align: center;
        }

        .article-footer .form-control-lg {
            max-width: 400px; /* Constrain newsletter input width */
            margin: 0 auto;
            background-color: var(--dark-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .article-footer .form-control-lg::placeholder {
            color: var(--text-secondary);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .article-header {
                padding: 5rem 0 3rem;
            }
            
            .article-title {
                font-size: 2rem;
            }
            
            .article-meta {
                flex-direction: column;
                align-items: flex-start; /* Align left for better mobile appearance */
                gap: 0.75rem;
            }
            
            .back-button {
                top: 1rem;
                left: 1rem;
            }
            
            .back-button .btn {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }
            
            .share-buttons {
                justify-content: center;
                flex-direction: column; /* Stack share buttons on small screens */
                align-items: stretch; /* Make them full width */
            }

            .share-buttons .d-flex {
                justify-content: center; /* Center buttons within the flex container */
                width: 100%;
            }

            .share-buttons .btn {
                flex-grow: 1; /* Allow buttons to expand */
                max-width: 150px; /* Limit max width for smaller buttons */
            }
            
            .article-content {
                font-size: 1rem;
                padding: 0 1rem; /* Adjust padding for mobile */
            }
            
            .article-content h1 {
                font-size: 1.8rem;
            }
            
            .article-content h2 {
                font-size: 1.5rem;
            }
            
            .article-content h3 {
                font-size: 1.3rem;
            }

            .author-card {
                padding: 1.5rem;
            }

            .author-card .d-flex {
                flex-direction: column;
                text-align: center;
            }

            .author-card img {
                margin-bottom: 1rem;
                margin-right: 0 !important; /* Override me-3 */
            }
        }
        /* Mobile specific adjustments for content width */
        @media (max-width: 576px) {
            .article-content {
                padding: 0 0.5rem; /* Even tighter padding for very small screens */
            }
        }

    </style>
</head>
<body>
    <div class="back-button">
        <a href="/blog" class="btn" aria-label="Volver al Blog">
            <i class="fas fa-arrow-left" aria-hidden="true"></i> Volver al Blog
        </a>
    </div>

    <header class="article-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 mx-auto text-center">
                    <h1 class="article-title">Introducción</h1>
                    <div class="article-meta justify-content-center">
                        <span><i class="far fa-calendar-alt" aria-hidden="true"></i> 2025-07-27</span> <span><i class="far fa-clock" aria-hidden="true"></i> 5 min de lectura</span>
                        <span><i class="far fa-user" aria-hidden="true"></i> Por hgaruna</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="row">
            <div class="col-lg-10 mx-auto">
                <div class="featured-image mb-5 text-center">
                    <img src="/logos-he-imagenes/programacion.jpeg" alt="La Content Security Policy (CSP) es un mecanismo de seguridad HTTP que permite a los desarrolladores web controlar los recursos que el navegador puede cargar pa" class="img-fluid rounded-3"> </div>
                
                <article class="article-content">
                    <main>
  <h2>Introducción</h2>
  <p>La Content Security Policy (CSP) es un mecanismo de seguridad HTTP que permite a los desarrolladores web controlar los recursos que el navegador puede cargar para una página web dada.  Esto ayuda a mitigar los riesgos de ataques como el Cross-Site Scripting (XSS) y otros tipos de inyección de código malicioso. En esencia, CSP define una política de seguridad que el navegador debe aplicar rigurosamente, bloqueando cualquier recurso que no cumpla con las directivas especificadas.  Implementar una CSP eficaz es una parte crucial de una estrategia de seguridad web robusta.</p>

  <h2>Sección Principal</h2>
  <p>Una CSP se define mediante un encabezado HTTP, <code>Content-Security-Policy</code>, o a través de una etiqueta <code>meta</code>.  Este encabezado o etiqueta contiene una lista de directivas, cada una especificando qué tipos de recursos se permiten cargar y de dónde.  Si un recurso intenta cargarse y no cumple con la política definida, el navegador lo bloqueará, previniendo potenciales ataques.  El uso de CSP es altamente recomendado para cualquier sitio web que maneje datos sensibles o información de usuario.</p>

  <h3>Directivas CSP comunes</h3>
  <p>Existen varias directivas CSP, cada una con su propio propósito. Algunas de las más comunes incluyen:</p>
  <ul>
    <li><code>default-src</code>:  Define una política por defecto para todos los tipos de recursos si no se especifica otra directiva.  Es una buena práctica siempre definir esta directiva.</li>
    <li><code>script-src</code>: Especifica las fuentes permitidas para scripts.  Esto es crucial para prevenir ataques XSS.</li>
    <li><code>style-src</code>: Especifica las fuentes permitidas para hojas de estilo.</li>
    <li><code>img-src</code>: Especifica las fuentes permitidas para imágenes.</li>
    <li><code>font-src</code>: Especifica las fuentes permitidas para fuentes.</li>
    <li><code>object-src</code>: Especifica las fuentes permitidas para objetos como <object>, <embed> y <applet>.</li>
    <li><code>media-src</code>: Especifica las fuentes permitidas para archivos de audio y video.</li>
    <li><code>frame-src</code>: Especifica las fuentes permitidas para iframes.</li>
    <li><code>connect-src</code>: Especifica las fuentes permitidas para conexiones de red, incluyendo solicitudes Fetch y XMLHttpRequest.</li>
    <li><code>base-uri</code>: Especifica las fuentes permitidas para la etiqueta <code><base></code>.</li>
    <li><code>form-action</code>: Especifica las URLs permitidas para las acciones de los formularios.</li>
    <li><code>frame-ancestors</code>: Especifica las fuentes permitidas que pueden incrustar la página actual en un iframe.</li>
    <li><code>child-src</code>: (Obsoleta, reemplazada por <code>frame-src</code> y <code>worker-src</code>) Especifica las fuentes permitidas para frames, workers y otros contextos de navegación de la página.</li>
    <li><code>worker-src</code>: Especifica las fuentes permitidas para los Web Workers.</li>
    <li><code>manifest-src</code>: Especifica las fuentes permitidas para archivos de manifest.</li>
    <li><code>report-uri</code>: Especifica una URL donde se enviarán los informes de violaciones de la CSP.</li>
    <li><code>report-to</code>: Especifica un grupo de reporting para informes de violaciones de la CSP (más avanzado que `report-uri`).</li>
    <li><code>sandbox</code>: Aplica una serie de restricciones de seguridad a la página.</li>
    <li><code>upgrade-insecure-requests</code>: Reemplaza las solicitudes HTTP con HTTPS.</li>
  </ul>


  <h3>Ejemplo de implementación</h3>
  <p>Un ejemplo simple de una CSP que permite scripts solo desde el mismo origen y las imágenes desde un CDN específico:</p>
  <pre><code class="language-javascript">Content-Security-Policy: default-src 'self'; script-src 'self'; img-src 'self' https://cdn.example.com;</code></pre>

  <p>Este ejemplo utiliza la directiva <code>'self'</code>, que se refiere al mismo origen de la página.  Es importante destacar que  <code>'self'</code>  incluye el protocolo, el nombre de dominio y el puerto.  Si la página se carga con HTTPS, solo se permitirán recursos con HTTPS.  Si se carga con HTTP, solo se permitirán recursos con HTTP.</p>

  <h3>Ejemplo con Report-URI</h3>
  <p>Para monitorear las violaciones de la CSP, es útil especificar una <code>report-uri</code>.  Esto enviará informes a la URL especificada cada vez que se produzca una violación.  Esto permite identificar y solucionar posibles problemas de configuración.</p>
  <pre><code class="language-javascript">Content-Security-Policy: default-src 'self'; script-src 'self'; report-uri /csp-reports;</code></pre>
  <p>En este ejemplo, los informes se enviarán a la URL <code>/csp-reports</code> en el mismo servidor.  Recuerda que necesitas implementar un endpoint para manejar estos informes.</p>


  <h3>Consideraciones importantes</h3>
  <ol>
    <li><strong>Comenzar con una política restrictiva y relajarla gradualmente:</strong> Es mejor comenzar con una política muy restrictiva y luego ir relajando las directivas según sea necesario, monitoreando las violaciones a través de la <code>report-uri</code>.</li>
    <li><strong>Pruebas exhaustivas:</strong>  Antes de implementar una CSP en producción, es crucial realizar pruebas exhaustivas para asegurar que todas las funcionalidades del sitio web funcionen correctamente.</li>
    <li><strong>Monitoreo continuo:</strong>  Después de implementar la CSP, es importante monitorear los informes de violaciones para identificar y solucionar cualquier problema.</li>
    <li><strong>Compatibilidad del navegador:</strong> Asegúrate de que tu CSP sea compatible con los navegadores que deseas admitir.  La compatibilidad ha mejorado significativamente, pero siempre es prudente verificar la documentación.</li>
    <li><strong>Nonce y Hash:</strong> Para permitir scripts generados dinámicamente de forma segura, considera el uso de <code>nonce</code> o <code>hash</code> en la directiva <code>script-src</code>.</li>
  </ol>

  <h2>Conclusión</h2>
  <p>Implementar una Content Security Policy es una práctica de seguridad esencial para cualquier sitio web.  Aunque puede requerir un esfuerzo inicial de configuración y pruebas, los beneficios en términos de seguridad superan ampliamente los costos.  Al comprender las directivas CSP y seguir las mejores prácticas, puedes proteger significativamente tu sitio web contra una variedad de ataques comunes, mejorando la seguridad y la confianza de tus usuarios.</p>
  <p>Recuerda que una CSP bien configurada es una capa de defensa crucial, pero no la única.  Es importante combinarla con otras medidas de seguridad, como el uso de HTTPS, la validación de entradas y la gestión segura de contraseñas, para lograr una protección completa.</p>
</main>

                </article>
                
                <div class="article-tags">
                    <a href="/blog/tag/javascript" class="tag">#JavaScript</a><a href="/blog/tag/seguridad" class="tag">#Seguridad</a><a href="/blog/tag/ia" class="tag">#IA</a> 
                </div>
                
                <div class="share-buttons mb-5">
                    <h4 class="mb-3">Compartir este artículo:</h4>
                    <div class="d-flex flex-wrap gap-2">
                        <a href="#" onclick="shareOnTwitter(); return false;" class="btn btn-primary share-twitter"> <i class="fab fa-twitter me-1" aria-hidden="true"></i> Twitter
                        </a>
                        <a href="#" onclick="shareOnFacebook(); return false;" class="btn btn-primary share-facebook">
                            <i class="fab fa-facebook-f me-1" aria-hidden="true"></i> Facebook
                        </a>
                        <a href="#" onclick="shareOnLinkedIn(); return false;" class="btn btn-primary share-linkedin">
                            <i class="fab fa-linkedin-in me-1" aria-hidden="true"></i> LinkedIn
                        </a>
                        <a href="#" onclick="shareOnWhatsApp(); return false;" class="btn btn-primary share-whatsapp">
                            <i class="fab fa-whatsapp me-1" aria-hidden="true"></i> WhatsApp
                        </a>
                    </div>
                </div>
                
                <div class="author-card bg-dark p-4 rounded-3 mt-5">
                    <div class="d-flex align-items-center">
                        <img src="/logos-he-imagenes/logo.png" alt="Logo de hgaruna, desarrollador web y escritor técnico" class="rounded-circle me-3" width="80" height="80" loading="lazy"> <div>
                            <h4 class="mb-1">hgaruna</h4>
                            <p class="text-muted mb-2">Experto en desarrollo web y tecnología</p>
                            <div class="social-links">
                                <a href="https://twitter.com/hgaruna" class="text-primary me-3" target="_blank" rel="noopener noreferrer nofollow" aria-label="Twitter de hgaruna"> <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
                                </a>
                                <a href="https://github.com/hgaruna" class="text-primary me-3" target="_blank" rel="noopener noreferrer nofollow" aria-label="GitHub de hgaruna">
                                    <i class="fab fa-github fa-lg" aria-hidden="true"></i>
                                </a>
                                <a href="https://linkedin.com/in/hgaruna" class="text-primary" target="_blank" rel="noopener noreferrer nofollow" aria-label="LinkedIn de hgaruna">
                                    <i class="fab fa-linkedin-in fa-lg" aria-hidden="true"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <footer class="article-footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto text-center">
                    <h3 class="mb-4">¿Te gustó este artículo?</h3>
                    <p class="lead mb-4">Suscríbete a nuestro boletín para recibir más contenido como este directamente en tu correo.</p>
                    <form class="row g-3 justify-content-center">
                        <div class="col-md-8">
                            <label for="newsletterEmail" class="visually-hidden">Tu correo electrónico</label> <input type="email" class="form-control form-control-lg" id="newsletterEmail" placeholder="Tu correo electrónico" required aria-label="Introduce tu correo electrónico para suscribirte">
                        </div>
                        <div class="col-md-auto">
                            <button type="submit" class="btn btn-primary btn-lg">Suscribirme</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    
    <script>
        // Obtener el título y la URL actual
        const currentUrl = encodeURIComponent(window.location.href);
        const currentTitle = encodeURIComponent(document.title);
        
        // Función para compartir en Twitter
        function shareOnTwitter() {
            const text = `${currentTitle} por @hgaruna`;
            window.open(`https://twitter.com/intent/tweet?url=${currentUrl}&text=${text}`, '_blank', 'width=550,height=420');
            return false; // Prevent default link behavior
        }
        
        // Función para compartir en Facebook
        function shareOnFacebook() {
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${currentUrl}`, '_blank', 'width=600,height=500');
            return false;
        }
        
        // Función para compartir en LinkedIn
        function shareOnLinkedIn() {
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${currentUrl}`, '_blank', 'width=600,height=500');
            return false;
        }
        
        // Función para compartir en WhatsApp
        function shareOnWhatsApp() {
            const text = `${currentTitle} - ${currentUrl}`;
            window.open(`https://wa.me/?text=${text}`, '_blank');
            return false;
        }
        
        // Add copy-to-clipboard functionality to code blocks
        document.addEventListener('DOMContentLoaded', function() {
            // Apply integrity attributes to local scripts if any (not applicable here as all are external)
            
            // Share buttons: the onclick functions already use currentUrl, so no need for this block unless templating variables were still there.
            // Keeping the original logic just in case, but it's redundant with the `const currentUrl = encodeURIComponent(window.location.href);`
            // and direct calls.
            /*
            document.querySelectorAll('[onclick*="shareOn"]').forEach(link => {
                const onclick = link.getAttribute('onclick');
                link.setAttribute('onclick', onclick.replace(/https://www.hgaruna.org/blog/content-security-policy-csp.html/g, window.location.href));
            });
            */

            // Copy code to clipboard
            document.querySelectorAll('pre').forEach(function(preBlock) {
                const button = document.createElement('button');
                button.className = 'copy-code-btn';
                button.textContent = 'Copiar';
                preBlock.appendChild(button);

                button.addEventListener('click', function() {
                    const code = preBlock.querySelector('code').innerText;
                    navigator.clipboard.writeText(code).then(function() {
                        button.textContent = '¡Copiado!';
                        setTimeout(function() {
                            button.textContent = 'Copiar';
                        }, 2000);
                    }).catch(function(err) {
                        console.error('Error al copiar el código:', err);
                    });
                });
            });

            // Smooth scroll for internal links (already present, just ensure it works)
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
        });
    </script>
</body>
</html>
