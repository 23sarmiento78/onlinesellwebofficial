// Script de prueba para el sistema autom√°tico de publicaciones del foro
window.simulateArticlePublication = function(articleData) {
  console.log('ü§ñ Simulando publicaci√≥n autom√°tica de art√≠culo:', articleData.title);
  
  // Verificar que el foro est√© cargado
  if (typeof window.foroManager === 'undefined') {
    console.log('‚è≥ Esperando a que el foro se cargue...');
    setTimeout(() => window.simulateArticlePublication(articleData), 1000);
    return;
  }

  // Crear contenido para la publicaci√≥n del foro
  const forumContent = `üìù **Nuevo art√≠culo publicado:** ${articleData.title}

${articleData.description}

üîó **Leer art√≠culo completo:** [${articleData.title}](${articleData.articleUrl})

üè∑Ô∏è **Categor√≠a:** ${articleData.category}
üìÖ **Publicado:** ${new Date(articleData.publishedAt).toLocaleDateString('es-ES')}

¬øQu√© opinas sobre este tema? ¬°Comparte tus experiencias en los comentarios!`;

  // Crear la publicaci√≥n en el foro
  const newPost = window.foroManager.createPost(
    forumContent,
    articleData.image,
    articleData.category,
    articleData.tags
  );

  // Marcar como publicaci√≥n autom√°tica
  newPost.isAutoGenerated = true;
  window.foroManager.savePosts();

  // Mostrar estad√≠sticas
  setTimeout(() => {
    const stats = {
      totalPosts: window.foroManager.posts.length,
      autoGenerated: window.foroManager.posts.filter(p => p.isAutoGenerated).length,
      totalComments: Object.values(window.foroManager.comments).reduce((sum, comments) => sum + comments.length, 0),
      totalLikes: window.foroManager.posts.reduce((sum, post) => sum + post.likes, 0)
    };

    console.log('üìä Estad√≠sticas del foro:', stats);
    
    // Mostrar notificaci√≥n
    if (window.foroManager.showNotification) {
      window.foroManager.showNotification(
        `‚úÖ Art√≠culo "${articleData.title}" publicado autom√°ticamente en el foro`,
        'success'
      );
    }
  }, 500);

  return newPost;
};

// Funci√≥n para simular m√∫ltiples publicaciones
window.simulateMultiplePublications = function() {
  const articles = [
    {
      id: '2025-01-22-desarrollo-web-villa-carlos-paz',
      title: 'Desarrollo Web Profesional en Villa Carlos Paz: Potenciando Negocios Locales',
      description: 'Descubre c√≥mo el desarrollo web profesional est√° transformando los negocios en Villa Carlos Paz, C√≥rdoba. Soluciones digitales a medida para empresas locales.',
      category: 'Desarrollo Web Local',
      tags: ['Villa Carlos Paz', 'Desarrollo Web', 'Marketing Digital', 'C√≥rdoba', 'Negocios Locales', 'SEO Local'],
      image: '/logos-he-imagenes/programacion.jpeg',
      publishedAt: '2025-01-22',
      author: 'hgaruna',
      articleUrl: '/blog/2025-01-22-desarrollo-web-villa-carlos-paz/'
    },
    {
      id: '2024-03-15-10-estrategias-seo-avanzadas',
      title: '10 Estrategias SEO Avanzadas para 2024',
      description: 'Descubre las t√©cnicas m√°s efectivas de SEO para mejorar el posicionamiento de tu sitio web en los motores de b√∫squeda.',
      category: 'SEO',
      tags: ['SEO', 'Marketing Digital', 'Posicionamiento', 'Google', 'Optimizaci√≥n'],
      image: '/logos-he-imagenes/programacion.jpeg',
      publishedAt: '2024-03-15',
      author: 'hgaruna',
      articleUrl: '/blog/2024-03-15-10-estrategias-seo-avanzadas/'
    }
  ];

  console.log('üöÄ Iniciando simulaci√≥n de m√∫ltiples publicaciones...');
  
  articles.forEach((article, index) => {
    setTimeout(() => {
      window.simulateArticlePublication(article);
    }, index * 2000); // 2 segundos entre cada publicaci√≥n
  });
};

// Funci√≥n para limpiar datos de prueba
window.clearTestData = function() {
  if (confirm('¬øEst√°s seguro de que quieres limpiar todos los datos del foro? Esta acci√≥n no se puede deshacer.')) {
    localStorage.removeItem('foro_posts');
    localStorage.removeItem('foro_comments');
    localStorage.removeItem('foro_temp_user');
    
    if (window.foroManager) {
      window.foroManager.posts = [];
      window.foroManager.comments = {};
      window.foroManager.savePosts();
      window.foroManager.saveComments();
      window.foroManager.renderPosts();
    }
    
    console.log('üßπ Datos del foro limpiados');
    location.reload();
  }
};

// Funci√≥n para mostrar estad√≠sticas en tiempo real
window.showForumStats = function() {
  if (typeof window.foroManager === 'undefined') {
    console.log('‚ùå El foro no est√° cargado');
    return;
  }

  const stats = {
    totalPosts: window.foroManager.posts.length,
    autoGenerated: window.foroManager.posts.filter(p => p.isAutoGenerated).length,
    manualPosts: window.foroManager.posts.filter(p => !p.isAutoGenerated).length,
    totalComments: Object.values(window.foroManager.comments).reduce((sum, comments) => sum + comments.length, 0),
    totalLikes: window.foroManager.posts.reduce((sum, post) => sum + post.likes, 0),
    totalShares: window.foroManager.posts.reduce((sum, post) => sum + post.shares, 0),
    categories: [...new Set(window.foroManager.posts.map(p => p.category))],
    currentUser: window.foroManager.currentUser.name
  };

  console.log('üìä Estad√≠sticas del Foro:', stats);
  
  // Crear notificaci√≥n con estad√≠sticas
  const statsText = `
üìä Estad√≠sticas del Foro:
‚Ä¢ Publicaciones totales: ${stats.totalPosts}
‚Ä¢ Autom√°ticas: ${stats.autoGenerated}
‚Ä¢ Manuales: ${stats.manualPosts}
‚Ä¢ Comentarios: ${stats.totalComments}
‚Ä¢ Me gusta: ${stats.totalLikes}
‚Ä¢ Compartidos: ${stats.totalShares}
‚Ä¢ Categor√≠as: ${stats.categories.join(', ')}
‚Ä¢ Usuario actual: ${stats.currentUser}
  `;

  if (window.foroManager.showNotification) {
    window.foroManager.showNotification(statsText, 'info');
  }

  return stats;
};

// Funci√≥n para simular interacciones
window.simulateInteractions = function() {
  if (typeof window.foroManager === 'undefined') {
    console.log('‚ùå El foro no est√° cargado');
    return;
  }

  console.log('üé≠ Simulando interacciones...');

  // Simular likes en publicaciones
  window.foroManager.posts.forEach((post, index) => {
    setTimeout(() => {
      window.foroManager.toggleLike(post.id);
      console.log(`üëç Like en publicaci√≥n: ${post.content.substring(0, 50)}...`);
    }, index * 500);
  });

  // Simular comentarios
  setTimeout(() => {
    const comments = [
      '¬°Excelente art√≠culo! Muy √∫til para mi negocio.',
      'Gracias por compartir esta informaci√≥n.',
      '¬øTienes alg√∫n consejo adicional sobre este tema?',
      'Muy interesante, lo voy a implementar.',
      '¬øPodr√≠as hacer un art√≠culo sobre esto?'
    ];

    window.foroManager.posts.forEach((post, index) => {
      if (index < comments.length) {
        setTimeout(() => {
          window.foroManager.addComment(post.id, comments[index]);
          console.log(`üí¨ Comentario agregado: ${comments[index]}`);
        }, index * 1000);
      }
    });
  }, 2000);
};

// Auto-ejecutar cuando el DOM est√© listo
document.addEventListener('DOMContentLoaded', () => {
  console.log('üéØ Script de prueba del foro cargado');
  console.log('üìù Comandos disponibles:');
  console.log('‚Ä¢ window.simulateArticlePublication(articleData) - Publicar un art√≠culo');
  console.log('‚Ä¢ window.simulateMultiplePublications() - Publicar m√∫ltiples art√≠culos');
  console.log('‚Ä¢ window.showForumStats() - Mostrar estad√≠sticas');
  console.log('‚Ä¢ window.simulateInteractions() - Simular interacciones');
  console.log('‚Ä¢ window.clearTestData() - Limpiar datos de prueba');
}); 